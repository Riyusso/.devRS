RSNotify(Text, controlwidth=0, Timed=1250) ;RSNotify
{
	global SmartFade=0
    SetTimer, SmartAppear, Off
    SetTimer, SmartFade, Off
	Gui, RSNotify:Destroy
	Gui,RSNotify:New, +hwndRSNotify
	Gui, +LastFound +ToolWindow
	WinSet, Transparent, 0
	Gui, Color, 008383
	Gui, Margin, 0, 0
	Gui, Font, s10 Bold w640, Verdana
	whc:=47

	Gui, Font, s13 w720, Verdana
	Gui, -Border -Caption +AlwaysOnTop +ToolWindow +E0x20


	Gui, Add, Text,cffffff hwndTHWND y9 +Hidden +Center, %Text% 	; Fake text to get the width so the x can be calculated beforehand
	GuiControlGet, TC, Pos, %THWND% 	; Get the pos/size of the text into the TC variable, you can use the width of the text control with the variable 'TCW'
	if(controlwidth!=0)
		xcalc:=controlwidth/2-(TCW/2)
	else
		xcalc=13

	Gui, Add, Text,cffffff x%xcalc% y10 +Center, %Text%

	If controlwidth=0
		TCW:=(TCW+26)*dpi
	Else
		TCW:=controlwidth*dpi

	vhc:=A_ScreenHeight-106*dpi
	averagex:=A_ScreenWidth-120*dpi-(tcw*0.75)
	whc:=whc*dpi

	WinSet, Region, 0-0 h%whc% w%TCW% r3-3
	Gui, Show, x%averagex% y%vhc% h%whc% w%TCW% NoActivate
	GoSub SmartAppear
	SetTimer, SmartFade, -%Timed%
	return
}

SmartAppear:
	SmartFade:=SmartFade+8
	WinSet, Transparent, %SmartFade%, ahk_id %RSNotify%
	SetTimer, SmartAppear, -8
	If (SmartFade>204)
		SetTimer, SmartAppear, Off
return
	
SmartFade:
		SmartFade:=SmartFade-8
		WinSet, Transparent, %SmartFade%, ahk_id %RSNotify%
		SetTimer, SmartFade, -8
		If (SmartFade<9)
		{
			Gui, RSNotify:Destroy
			SetTimer, SmartFade, Off
		}
return