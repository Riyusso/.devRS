RunAsAdmin:
RunAsAdmin=1
IniWrite, %RunAsAdmin%, settings.ini, settings, RunAsAdmin
FadeOut(AdminPrompt)
GoSub Settings
return

NotAnAdmin:
RunAsAdmin=0
IniWrite, %RunAsAdmin%, settings.ini, settings, RunAsAdmin
FadeOut(AdminPrompt)
GoSub Settings
return

ARun:
IniRead, RunAsAdmin, settings.ini, settings, RunAsAdmin, 0
If RunAsAdmin
RunAsAdmin()
Else
GoSub RSRunScript
return

Reinstall:
	FileDelete, settings.ini
	Reload
return

UpdateCheck:
IniRead, ExitVar, build.ini, build, ExitVar
IniRead, ReloadVar, build.ini, build, ReloadVar
IniRead, PluginPath, build.ini, build, PluginPath
If ExitVar=1
	ExitApp
If ReloadVar=1 ; Used when installing a Plugin
{
	If(PluginPath!=ERROR)
	{
		FileCopy, %PluginPath%, PluginInstaller.exe, 1
		FileDelete, %PluginPath%
	}
	IniWrite, 0, build.ini, build, ReloadVar
	RSNotify("Plugin Added")
	Sleep 2000
	Reload
}
return

playpause:
	Send {Media_Play_Pause}
	RSNotify("Play/Pause")
return

ws1:
Run, %ws1%
SetTimer, WebLGuiEscape, -100
return

ws2:
Run, %ws2%
SetTimer, WebLGuiEscape, -100
return

ws3:
Run, %ws3%
SetTimer, WebLGuiEscape, -100
return

ws4:
Run, %ws4%
SetTimer, WebLGuiEscape, -100
return

ws5:
Run, %ws5%
SetTimer, WebLGuiEscape, -100
return

ws6:
Run, %ws6%
SetTimer, WebLGuiEscape, -100
return

ws7:
Run, %ws7%
SetTimer, WebLGuiEscape, -100
return

ws8:
Run, %ws8%
SetTimer, WebLGuiEscape, -100
return

plus1:
Formula:= Formula*10+1
GoSub PasswordCover
Gosub UnlockPC
return

plus2:
Formula:= Formula*10+2
GoSub PasswordCover
Gosub UnlockPC
return

plus3:
Formula:= Formula*10+3
GoSub PasswordCover
Gosub UnlockPC
return

plus4:
Formula:= Formula*10+4
GoSub PasswordCover
Gosub UnlockPC
return

plus5:
Formula:= Formula*10+5
GoSub PasswordCover
Gosub UnlockPC
return

plus6:
Formula:= Formula*10+6
GoSub PasswordCover
Gosub UnlockPC
return

plus7:
Formula:= Formula*10+7
GoSub PasswordCover
Gosub UnlockPC
return

plus8:
Formula:= Formula*10+8
GoSub PasswordCover
Gosub UnlockPC
return

plus9:
Formula:= Formula*10+9
GoSub PasswordCover
Gosub UnlockPC
return

plus0:
Formula:= Formula*10+0
GoSub PasswordCover
Gosub UnlockPC
return

NextSong:
	Send {Media_Next}
	RSNotify("Next", 100)
return

PrevSong:
	Send {Media_Prev}
	RSNotify("Previous")
return

GuiClose:
   Gui, Destroy
   CtlColors.Free()
GuiEscape:
	CtlColors.Free()
Return

GuiMove:
   PostMessage, 0xA1, 2
return

GuiFade:
	FadeOut(WarningGUI)
return

;=====------======------=====------======------=====------======------=====------======------=====------======------=====------======------
;=====------======------=====------======------=====------======------TRIGGERS-----======------======------=====------======------=====----
;=====------======------=====------======------=====------======------=====------======------=====------======------=====------======------

; LabelCheckTrigger: 			; if needed to recognise when particular windows are active (set a timer and create labels named LabelTriggerOn[number]/LabelTriggerOff[number] - it will go through all of them)
;
;  While ( ProgWinTitle%A_Index% != "" && WinTrigger := WinTrigger%A_Index% )
;    if ( !ProgRunning%A_Index% != !Win%WinTrigger%( ProgWinTitle := ProgWinTitle%A_Index% ) )
;      GoSubSafe( "LabelTriggerO" ( (ProgRunning%A_Index% := !ProgRunning%A_Index%) ? "n" : "ff" ) A_Index )
; Return


GoSubSafe(mySub)
{
	if IsLabel(mySub)
		GoSub %mySub%
}

;-------------------------------------------------------------------------------------------------------------

KeepTrans: ; keep both KeepTrans and TaskBarSet
	IniRead, TransparentStartMenu, settings.ini, settings, TransparentStartMenu, 255
	WinSet, Transparent, %TransparentStartMenu%, ahk_class Shell_TrayWnd
return

TaskBarSet: ; keep both KeepTrans and TaskBarSet
	WinSet, Transparent, %TransparentStartMenu%, ahk_class Shell_TrayWnd
return

;--------------------------------------------------------------------------------------------------------------

;--------------------------------------------------------------------------------------------------------------
GuiSize:
   If (A_EventInfo != 1)
   {
	  Gui, %A_Gui%:+LastFound
	  WinSet, ReDraw
   }
Return
; ----------------------------------------------------------------------------------------------------------------------
STDRBG:
   GuiControlGet, STDRB1
   CtlColors.Change(RBID1, (STDRB1 ? "Lime" : ""), "006000")
   CtlColors.Change(RBID2, (STDRB1 ? "" : "Lime"), "006000")
Return
; ----------------------------------------------------------------------------------------------------------------------
STDCB1:
   GuiControlGet, STDCB1
   CtlColors.Change(CBID1, (STDCB1 ? "Lime" : "C0C0C0"), "Red")
   Return
; ----------------------------------------------------------------------------------------------------------------------
RBG:
   RBG := SubStr(A_GuiControl, 3)
   If (RBG != RBGA)
   {
	  CtlColors.Detach(RTID%RBGA%)
	  CtlColors.Attach(RTID%RBG%, "Yellow", "Blue")
	  GuiControl, , RB%RBG%, 1
	  RBGA := RBG
   }
Return
; ----------------------------------------------------------------------------------------------------------------------
LB1:
   GuiControlGet, LB1
   StringSplit, LC, LB1, %A_Space%
   If (%LC2%)
   {
	  BG := %LC2%, TX := "White"
	  CtlColors.Change(LBID1, BG, TX)
	  SendMessage, LB_SETCURSEL, -1, 0, , ahk_id %LBID1%
   }
Return
; ----------------------------------------------------------------------------------------------------------------------
CB1:
   GuiControlGet, CB1
   If (A_GuiControl = "CT1")
	  CB1 ^= True
   If (CB1)
	  CtlColors.Change(CTID1, "Lime", "406060")
   Else
	  CtlColors.Change(CTID1, "", "Green")
   GuiControl, , CB1, %CB1%
Return
; ----------------------------------------------------------------------------------------------------------------------
CBB1:
Return