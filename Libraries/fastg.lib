GoogleOpener:
	If(A_ThisHotkey = A_PriorHotkey && A_TimeSincePriorHotkey < 250 && StrLen(lastcopied)>0) ; if you double tap RAlt it searches Google for whatever you have selected(or have in your clipboard)
	{ 		
		websearchvar:=lastcopied
		GuiControl, FastGoogle:, websearchvar, %lastcopied%
		Send {End}
		websearchvar:="https://www.google.bg/search?q=" websearchvar
		Run, %websearchvar%,, UseErrorLevel
		websearchvar=
		return
	}

	zfont=12
	amultiplier=1
	guiw:=695*amultiplier
	guih:=45
	buth:=(guih)/2-15
	butw:=(guiw)/4
	WSTog := !WSTog
	websearchvar=
	If !WSTog
	{
		SetTimer, CheckGoogleSearch, Off
		sleep 10
		FadeOut(FastGoogle)
		Gui, FastGoogle:Destroy
		lastcopied=
		return
	}
	oCB := ClipboardAll		; save clipboard contents
	Send, ^c
	clipboard:=RTrim(clipboard, " `t`r`n")		; trim left/right whitespaces
	clipboard:=LTrim(clipboard, " `t`r`n")
	lastcopied:=clipboard
	ClipBoard := oCB		; return original Clipboard contents

	Gui, FastGoogle:New, +hwndFastGoogle
	Gui, -Border -Caption +AlwaysOnTop +LastFound +ToolWindow
	Gui, Color,1e1e1e, 333333
	Gui, Font, w700 s%zfont% cD0D0D0, Segoe UI Black

	Gui, Add, Progress, % "x-1 y-1 w" guiw " h22 Background333333 Disabled hwndHPROG"
	
	Gui, Add, Edit, % "x0 y17 w" guiw-47 " h25 hwndWebSearch vwebsearchvar -E0x200 +Center -VScroll", %websearchvar%
	SHAutoComplete(WebSearch)
	Gui, Add, Button, % "x+0 h25 w47 gFastGoogleSearch hwndSearchBut1 +Default", Go
	Opt1 := [6, 0x333333, 0x333333, 0x008383]
	Opt2 := [ , 0x333333, 0x333333, 0xffffff]
	Opt4 := [0, 0xC0A0A0A0, , 0xC0606000]
	ImageButton.Create(SearchBut1, Opt1, Opt2, "", Opt4)
	guiw:=guiw*dpi
	guih:=guih*dpi
	WinSet, Region, 0-0 w%guiw% h%guih% r18-18
	WinSet, Transparent, 243
	Gui, Show, y-14 h%guih% w%guiw%, .devRS Google Search

	SetTimer, CheckGoogleSearch, 50
return

#If	WinActive( "ahk_id" . FastGoogle )
	ESC::
	FadeOut(FastGoogle)
	lastcopied=
	return
#If

FastGoogleSearch:
	Gui, Submit, NoHide
	if(websearchvar!="")
	{	
		Loop, Parse, websearchvar
		If (A_LoopField=.) 
		{
			WSTog:=!WSTog
			SetTimer, CheckGoogleSearch, Off
			Run, http:%websearchvar%
			websearchvar=
			lastcopied=
			FadeOut(FastGoogle)
			Gui, FastGoogle:Destroy
			return
		}
		WSTog:=!WSTog
		SetTimer, CheckGoogleSearch, Off
		websearchvar:="https://www.google.bg/search?q=" websearchvar
		Run, %websearchvar%,, UseErrorLevel
		websearchvar=
	}
	lastcopied=
	FadeOut(FastGoogle)
	Gui, FastGoogle:Destroy
return

CheckGoogleSearch:
	IfWinNotActive, ahk_id %FastGoogle%
	{
		sleep 40
		WSTog:=!WSTog
		FadeOut(FastGoogle)
		lastcopied=
		Gui, FastGoogle:Destroy
		SetTimer, CheckGoogleSearch, Off
		sleep 10
	}
return

SHAutoComplete(hEdit)	; adds the ability to insert control characters from the Ascii table (such as ctrl + backspace)
{
	DllCall("ole32\CoInitialize", "Uint", 0)
	DllCall("shlwapi\SHAutoComplete", "Uint", hEdit, "Uint",0x80000000|0x20000000)
	DllCall("ole32\CoUninitialize")
}